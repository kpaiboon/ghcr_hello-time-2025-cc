version: "3.8"

services:
  rust-hello-time:
    image: ghcr.io/olive-techno/ghcr_hello-time/rusty-webserver:main
    deploy:
      mode: replicated
      replicas: 2
    networks:
      - proxy-net
    ports:
      - target: 8080
        published: 8125
        protocol: tcp
        mode: ingress
    healthcheck:
      #test: ["CMD", "curl", "-f", "http://localhost:8080"]
      test: ["CMD", "nc", "-z", "localhost", "8080"] # Option 2: Use a simple TCP check
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

networks:
  proxy-net:
    external: true


#
# üìù Proxy Host Configuration: rust-hello.olive.co.th
# üîß General Settings
# Domain Names: rust-hello.olive.co.th
# Scheme: http
# Forward Hostname / IP: rust-hello-time
# Forward Port: 8080
# Access List: Publicly Accessible
# üîê SSL Settings
# SSL Certificate: rust-hello.olive.co.th
# Force SSL: ‚úÖ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î)
# HTTP/2 Support: ‚úÖ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)


